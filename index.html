<!DOCTYPE html>
<html>
<head>
    <title>Andy Sphere Sumo 3D</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: 'Courier New', Courier, monospace; }
        #ui {
            position: absolute; top: 20px; left: 20px; color: #0f0;
            text-shadow: 2px 2px 0px #000; font-size: 18px; pointer-events: none; z-index: 10;
        }
        #overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: white; display: flex; justify-content: center;
            align-items: center; z-index: 100;
        }
    </style>
</head>
<body>

<div id="ui">
    <b>GOAL: REACH THE GOLDEN ANDY</b><br>
    CONTROLS: WASD + SPACE<br>
    DON'T LET THE ANDY BOTS BUMP YOU OFF
</div>

<div id="overlay">
    <button onclick="start()" style="padding: 20px 40px; font-size: 24px; cursor: pointer; background: #ff00ea; color: white; border: none; border-radius: 10px;">ENTER ANDY'S SUMO REALM</button>
</div>

<!-- Audio stays as requested -->
<audio id="music" loop><source src="mingleboosted.mp3"></audio>

<script type="importmap">
    { "imports": { "three": "https://unpkg.com" } }
</script>

<script type="module">
import * as THREE from 'three';

let scene, camera, renderer, player, goal;
let enemies = [];
const keys = {};

// Load all textures
const loader = new THREE.TextureLoader();
const textures = {
    andy1: loader.load('andyspin.jpg'),
    andy2: loader.load('andyspin2.jpg'),
    andy3: loader.load('andyspin3.jpg'),
    andy4: loader.load('andyspin4.jpg'),
    side: loader.load('andyside.jpg'),
    gif: loader.load('andyvid.gif')
};

function init() {
    scene = new THREE.Scene();

    // 1. THE SKYBOX: Fills the entire sky with Andy images/gifs
    const skyMaterialArray = [
        new THREE.MeshBasicMaterial({ map: textures.gif, side: THREE.BackSide }),
        new THREE.MeshBasicMaterial({ map: textures.andy2, side: THREE.BackSide }),
        new THREE.MeshBasicMaterial({ map: textures.gif, side: THREE.BackSide }),
        new THREE.MeshBasicMaterial({ map: textures.andy3, side: THREE.BackSide }),
        new THREE.MeshBasicMaterial({ map: textures.andy4, side: THREE.BackSide }),
        new THREE.MeshBasicMaterial({ map: textures.side, side: THREE.BackSide })
    ];
    const skyboxGeo = new THREE.BoxGeometry(200, 200, 200);
    const skybox = new THREE.Mesh(skyboxGeo, skyMaterialArray);
    scene.add(skybox);

    camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    
    renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    scene.add(new THREE.AmbientLight(0xffffff, 2));

    // 2. THE PLATFORM (Using andyside.jpg)
    const platformGroup = new THREE.Group();
    const platMat = new THREE.MeshStandardMaterial({ map: textures.side });
    
    for (let z = 0; z < 15; z++) {
        for (let x = 0; x < 5; x++) {
            // Logic for holes: skip random sections
            if ((x === 2 && z === 5) || (x === 1 && z === 10) || (x === 3 && z === 12)) continue;
            
            const tile = new THREE.Mesh(new THREE.BoxGeometry(8, 1, 8), platMat);
            tile.position.set(x * 8 - 16, 0, z * -8 + 10);
            platformGroup.add(tile);
        }
    }
    scene.add(platformGroup);

    // 3. THE PLAYER (andyspin.jpg)
    player = new THREE.Mesh(new THREE.SphereGeometry(1, 32, 32), new THREE.MeshStandardMaterial({ map: textures.andy1 }));
    player.position.set(0, 2, 8);
    player.velocity = new THREE.Vector3();
    scene.add(player);

    // 4. THE ENEMIES (Mixed Andy textures)
    const enemyTextures = [textures.andy2, textures.andy3, textures.andy4];
    for(let i = 0; i < 8; i++) {
        let tex = enemyTextures[i % 3];
        let enemy = new THREE.Mesh(new THREE.SphereGeometry(1, 32, 32), new THREE.MeshStandardMaterial({ map: tex }));
        enemy.position.set(Math.random() * 20 - 10, 2, Math.random() * -60);
        enemy.velocity = new THREE.Vector3();
        enemies.push(enemy);
        scene.add(enemy);
    }

    // 5. THE GOAL (Golden Andy)
    goal = new THREE.Mesh(new THREE.SphereGeometry(2, 32, 32), new THREE.MeshStandardMaterial({ color: 0xffd700, emissive: 0xffaa00 }));
    goal.position.set(0, 1, -100);
    scene.add(goal);

    animate();
}

function updatePhysics(obj, isPlayer) {
    const drag = 0.96;
    const gravity = -0.02;

    if (isPlayer) {
        const pSpeed = 0.04;
        if (keys['w']) obj.velocity.z -= pSpeed;
        if (keys['s']) obj.velocity.z += pSpeed;
        if (keys['a']) obj.velocity.x -= pSpeed;
        if (keys['d']) obj.velocity.x += pSpeed;
        // Jump logic
        if (keys[' '] && obj.position.y < 1.1) obj.velocity.y = 0.4;
    }

    obj.velocity.y += gravity;
    obj.velocity.x *= drag;
    obj.velocity.z *= drag;
    obj.position.add(obj.velocity);

    // Platform collision (Simulated)
    if (obj.position.y < 1 && obj.position.y > -1) {
        // Simple bounds check for platform area
        if (Math.abs(obj.position.x) < 22 && obj.position.z < 15 && obj.position.z > -110) {
            obj.position.y = 1;
            obj.velocity.y = 0;
        }
    }

    // Reset if fall
    if (obj.position.y < -15) {
        if (isPlayer) {
            obj.position.set(0, 5, 8);
            obj.velocity.set(0,0,0);
        } else {
            obj.position.set(Math.random() * 20 - 10, 5, -40);
        }
    }
}

function animate() {
    requestAnimationFrame(animate);

    updatePhysics(player, true);

    enemies.forEach(en => {
        // AI: Aggressive targeting
        const moveDir = new THREE.Vector3().subVectors(player.position, en.position).normalize();
        en.velocity.add(moveDir.multiplyScalar(0.012));
        updatePhysics(en, false);

        // Sumo Collision
        if (player.position.distanceTo(en.position) < 2) {
            const force = new THREE.Vector3().subVectors(player.position, en.position).normalize();
            player.velocity.add(force.multiplyScalar(0.3));
            en.velocity.add(force.multiplyScalar(-0.3));
        }
    });

    // Camera
    camera.position.lerp(new THREE.Vector3(player.position.x, player.position.y + 6, player.position.z + 12), 0.1);
    camera.lookAt(player.position);

    // Win check
    if (player.position.distanceTo(goal.position) < 3) {
        alert("VICTORY! YOU HAVE REACHED THE GOLDEN ANDY!");
        player.position.set(0, 5, 8);
    }

    renderer.render(scene, camera);
}

window.start = () => {
    document.getElementById('overlay').style.display = 'none';
    document.getElementById('music').play();
    init();
};

window.addEventListener('keydown', e => keys[e.key.toLowerCase()] = true);
window.addEventListener('keyup', e => keys[e.key.toLowerCase()] = false);
window.addEventListener('resize', () => {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>
</body>
</html>
